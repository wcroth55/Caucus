#!/bin/sh
#
#---MKCAUHTML3.   Make the cookie & openid Caucus login page.
#
#   Input arguments:
#     $1   www hostname
#     $2   Caucus userid
#     $3   sweb alias
#     $4   reg  alias
#     $5   http protocol to use
#
#: CR 02/15/10 New file based on mkcauhtml2.
#------------------------------------------------------------------------

echo "<html>"
echo "<!--Prototype Caucus log-in page."
echo "-"
echo "-   Use this page by itself, or as an HTML fragment, to provide"
echo "-   a simple log-in point for your Caucus users."
echo "-"
echo "-   Note that this log-in method requires cookies; if a user's"
echo "-   browser has cookies disabled, they will get an informative"
echo "-   pop-up page (nocookies.html) that describes their options."
echo "-->"
echo ""
echo "<head>"
echo "<title>Caucus Log In</title>"
echo ""
echo "<style type=\"text/css\">"
echo "   td.medium     { font-family: verdana, arial;  font-size: 80%;}"
echo "   td.mediumedge { font-family: verdana, arial;  font-size: 80%;"
echo "                   background-color: #0070FF;}"
echo "   td.small      { font-family: verdana, arial;  font-size: 60%;}"
echo "   td.edge       { background-color: #0070FF; }"
echo "     .tiny       { font-family: verdana, arial;  font-size: 60%;}"
echo "     .nav        { text-decoration: none ;       color: blue }"
echo "     .nav:hover  { text-decoration: underline;   color: blue }"
echo "   .loginbox { "
echo "      background: url(openid-bg.gif) no-repeat;"
echo "      background-color: #fff;"
echo "      padding-left: 18px;"
echo "   }"
echo "</style>"
echo ""
echo "<script language=\"Javascript\">"
echo "   var submitted = false;"
echo "   document.cookie = \"caucus_ver=xyz\";"
echo ""
echo "   function cookies_allowed() {"
echo "      if (submitted)  return false;"
echo "      if (document.cookie != null  &&  document.cookie.length > 0)  return true;"
echo "      "
echo "      cookie = window.open (\"nocookie.html\", \"nocookie\", "
echo "         \"toolbar,location,status,menubar,scrollbars,resizable,\" +"
echo "         \"width=600,height=400\");"
echo ""
echo "      cookie.focus();"
echo "      return false;"
echo "   }"
echo ""
echo "   /*** Add this URL's \"?xyz\" query string onto end of <form action=> string. */"
echo "   function form_add_querystring() {"
echo "      if (location.search != null  &&  location.search.length > 0) {"
echo "         document.clogin.action = document.clogin.action + location.search;"
echo "         if ( (atsign = location.search.indexOf('@')) > 0) {"
echo "            if (document.links[2]) {"
echo "               document.links[2].search += '&iface=' +"
echo "                                 location.search.substring (atsign);"
echo "            }"
echo "         }"
echo "      }"
echo "   }"
echo ""
echo "   function checkEnter (event) {"
echo "      if (document.layers) code = event.which;"
echo "      else                 code = event.keyCode;"
echo "      if (code == 13  &&  cookies_allowed()) {"
echo "         submitted = true;"
echo "         document.clogin.submit();"
echo "      }"
echo "   }"
echo "</script>"
echo ""
echo "</head>"
echo ""
echo "<body bgcolor=\"#A0A0A0\" "
echo "       onLoad=\"document.clogin.userid.focus();  form_add_querystring();\">"
echo "<center>"
echo ""
echo "&nbsp;<br>"
echo "<div style='width: 35%;'>"
echo "<form method=\"post\" name=\"clogin\"   onSubmit=\"return cookies_allowed();\""
echo "      action=\"$5://$1/$4/swebsock/0/0/CC51/main/login.cml\">"
echo ""
echo "<table border=0 cellspacing=0 cellpadding=0 bgcolor=\"#E0E0EF\" width='100%'>"
echo ""
echo "<tr class=\"edge\" valign=center>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<td class=\"mediumedge\"><img src=\"clearpix.gif\" width=1 height=4 alt=\"\""
echo "    ><br>&nbsp;&nbsp;&nbsp;&nbsp;<br"
echo "    ><img src=\"clearpix.gif\" width=1 height=4 alt=\"\"></td>"
echo "<td class=\"mediumedge\" colspan=2"
echo "   ><b><font color=white>Caucus Log In</font></b></td>"
echo "<td class=\"mediumedge\">&nbsp;</td>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo ""
echo "<tr>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<td colspan=4><img src=\"clearpix.gif\" width=1 height=7 alt=\"\"></td>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<tr>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<td class=\"small\">&nbsp;</td>"
echo "<td class=\"small\">&nbsp;User ID<br>"
echo "    &nbsp;<input type=\"text\"     size=\"16\" name=\"userid\" tabindex=\"1\""
echo "             onChange=\"cookies_allowed();\"></td>"
echo "<td valign=top align=right colspan=2 rowspan=3 class=\"medium\""
echo "   ><a href=\"http://caucuscare.com\" target=\"_blank\""
echo "   ><img src=\"logo_only.gif\" border=0 alt=\"CaucusCare.Com\""
echo "   ></a>&nbsp;&nbsp;</td>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo ""
echo "<tr>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<td colspan=2><img src=\"clearpix.gif\" width=1 height=7 alt=\"\"></td>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo ""
echo "<tr>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<td class=\"small\">&nbsp;</td>"
echo "<td class=\"small\">&nbsp;Password</td>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<tr>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<td class=\"small\">&nbsp;</td>"
echo "<td class=\"small\">&nbsp;<input type=\"password\" size=\"16\" name=\"password\""
echo "    tabindex=\"2\" onKeyPress=\"checkEnter(event);\">&nbsp;&nbsp;</td>"
echo "    <td><input type=\"image\" src=\"login.gif\" border=0 tabindex=\"3\"></td>"
echo "<td class=\"small\">&nbsp;</td>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo ""
echo "<tr>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<td colspan=4><img src=\"clearpix.gif\" width=1 height=11 alt=\"\"></td>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo ""
echo "<tr>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<td class=\"medium\">&nbsp;</td>"
echo "<td class=\"small\" colspan=2>&nbsp;<a class=\"nav\" tabindex=\"4\""
echo "     href=\"$5://$1/$4/swebsock/0/0/CC51/reg/reset.cml\""
echo "   >Forgot your password?</a></td>"
echo "<td class=\"medium\">&nbsp;</td>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo ""
echo "<tr>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<td colspan=4><img src=\"clearpix.gif\" width=1 height=13 alt=\"\"></td>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo ""
echo "<tr>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<td class=\"medium\">&nbsp;</td>"
echo "<td class=\"small\" colspan=2>&nbsp;<a class=\"nav\" tabindex=\"5\""
echo "  href=\"$5://$1/$4/swebsock/0/0/CC51/reg/register.cml?method=2\""
echo "    onClick=\"return cookies_allowed();\""
echo "   >New User Registration</a></td>"
echo "<td class=\"medium\">&nbsp;</td>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo ""
echo "<tr>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo "<td colspan=4>&nbsp;</td>"
echo "<td class=\"edge\"><img src=\"clearpix.gif\" width=2 height=1 alt=\"\"></td>"
echo ""
echo "<tr>"
echo "<td colspan=6 class=\"edge\"><img src=\"clearpix.gif\" width=2 height=2 alt=\"\"></td>"
echo "</table>"
echo "</form>"
echo ""
echo "<form method='get' name='clogin'   onSubmit='return cookies_allowed();'"
echo "      action='$5://$1/openid/start.cgi'>"
echo ""
echo "<table border=0 cellspacing=0 cellpadding=0 bgcolor=\"#E0E0EF\" width='100%'>"
echo "<tr>"
echo "<td colspan=6 class='edge'><img src='clearpix.gif' width=2 height=2 alt=''></td>"
echo "<tr>"
echo "<td class='edge'><img src='clearpix.gif' width=2 height=1 alt=''></td>"
echo "<td colspan=4>&nbsp;</td>"
echo "<td class='edge'><img src='clearpix.gif' width=2 height=1 alt=''></td>"
echo "<tr>"
echo "<td class='edge'><img src='clearpix.gif' width=2 height=1 alt=''></td>"
echo "<td class='small'>&nbsp;</td>"
echo "<td class='small' colspan=2>&nbsp;Or, use your"
echo "    <a href='http://www.openid.net' class='nav' target='_blank'"
echo "       ><b>OpenId</b></a></td>"
echo "<td class='small'>&nbsp;</td>"
echo "<td class='edge'><img src='clearpix.gif' width=2 height=1 alt=''></td>"
echo "<tr>"
echo "<td class='edge'><img src='clearpix.gif' width=2 height=1 alt=''></td>"
echo "<td class='small'>&nbsp;</td>"
echo "<td class='small'"
echo "   >&nbsp;<input type='text'     size='16' name='openid_identifier' tabindex='6'"
echo "             onChange='cookies_allowed();' class='loginbox'></td>"
echo "<td><input type='image' src='login.gif' border=0 tabindex='7'></td>"
echo "<td class='small'>&nbsp;</td>"
echo "<td class='edge'><img src='clearpix.gif' width=2 height=1 alt=''></td>"
echo "<tr>"
echo "<td class='edge'><img src='clearpix.gif' width=2 height=1 alt=''></td>"
echo "<td colspan=4>&nbsp;</td>"
echo "<td class='edge'><img src='clearpix.gif' width=2 height=1 alt=''></td>"
echo "<tr>"
echo "<td colspan=6 class='edge'><img src='clearpix.gif' width=2 height=2 alt=''></td>"
echo "</table>"
echo "<p>"
echo ""
echo "</form>"
echo "</div>"
echo "</center>"
echo "</body>"
echo "</html>"
#------------------------------------------------------------------------
